<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Multiplication Table (20x20)</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="alternate icon" href="favicon.ico">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: white;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 10px;
            min-height: calc(100vh - 20px);
        }

        .main-layout {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 10px;
        }

        .controls-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 8px;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }

        .header-section {
            position: relative;
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 5px;
            padding: 4px 0;
            border-bottom: 1px solid #e0e0e0;
            min-height: 100px;
        }

        .anna-header, .stacy-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 10px 15px;
            border-radius: 15px;
            transition: all 0.3s ease;
            position: absolute;
            top: 0;
        }

        .anna-header {
            left: 0;
        }

        .stacy-header {
            right: 0;
        }

        .anna-header {
            background: linear-gradient(45deg, #ff6b9d, #c44569);
            box-shadow: 0 3px 10px rgba(255, 107, 157, 0.3);
        }

        .stacy-header {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            box-shadow: 0 3px 10px rgba(78, 205, 196, 0.3);
        }

        .anna-header:hover, .stacy-header:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .header-photo {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 5px solid rgba(255, 255, 255, 0.9);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
        }

        .header-name {
            color: white;
            font-weight: 800;
            font-size: 1.7em;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }

        h1 {
            text-align: center;
            color: #333;
            margin: 0;
            font-size: 1.8em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            flex: 1;
        }

        .controls {
            display: flex;
            flex-direction: column;
            gap: 5px;
            margin-bottom: 5px;
        }


        .control-group {
            display: flex;
            flex-direction: column;
            align-items: stretch;
            gap: 3px;
            position: relative;
            background: white;
            padding: 5px 8px;
            border-radius: 6px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            min-width: 120px;
        }

        .control-group label {
            font-size: 1.2em;
            font-weight: bold;
            color: #555;
        }

        select {
            padding: 12px 20px;
            font-size: 1.2em;
            border: 3px solid #ddd;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 80px;
        }

        select:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        /* First Number Dropdown - Blue Theme */
        #first-number:not([value=""]) {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb) !important;
            border-color: #2196f3 !important;
            color: #1565c0 !important;
            font-weight: 600;
        }

        /* Second Number Dropdown - Green Theme */
        #second-number:not([value=""]) {
            background: linear-gradient(135deg, #e8f5e8, #c8e6c9) !important;
            border-color: #4caf50 !important;
            color: #2e7d32 !important;
            font-weight: 600;
        }

        .multiplication-display {
            position: absolute;
            top: 67%;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            text-align: center;
            padding: 8px 20px;
            border-radius: 8px;
            font-size: 1.2em;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            z-index: 100;
            white-space: nowrap;
        }

        .table-container {
            display: flex;
            justify-content: center;
            margin: 10px 0;
            overflow-x: auto;
        }

        .multiplication-table {
            border-collapse: collapse;
            border: 3px solid white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            font-size: 1.2em;
        }

        .table-cell {
            width: 50px;
            height: 50px;
            text-align: center;
            font-size: 1.1em;
            font-weight: bold;
            border: 1px solid white;
            position: relative;
            transition: all 0.3s ease;
            color: #000;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.8), -1px -1px 2px rgba(255,255,255,0.8), 1px -1px 2px rgba(255,255,255,0.8), -1px 1px 2px rgba(255,255,255,0.8);
        }

        /* Theme Styles */
        .theme-rainbow .table-cell {
            background: var(--cell-bg, #f0f0f0);
        }

        .theme-balerina .table-cell {
            background: var(--cell-bg, #f0f0f0);
        }

        .theme-capucina .table-cell {
            background: var(--cell-bg, #f0f0f0);
        }

        .theme-princess .table-cell {
            background: var(--cell-bg, #f0f0f0);
        }

        .theme-unicorn .table-cell {
            background: var(--cell-bg, #f0f0f0);
        }

        .theme-butterfly .table-cell {
            background: var(--cell-bg, #f0f0f0);
        }

        .theme-ocean .table-cell {
            background: var(--cell-bg, #f0f0f0);
        }

        .theme-forest .table-cell {
            background: var(--cell-bg, #f0f0f0);
        }

        .theme-space .table-cell {
            background: var(--cell-bg, #f0f0f0);
        }

        .theme-candy .table-cell {
            background: var(--cell-bg, #f0f0f0);
        }

        /* Fade effect for non-selected cells */
        .table-cell.faded {
            opacity: 0.3;
            filter: grayscale(50%);
            transition: all 0.3s ease;
        }

        .header-cell {
            background: linear-gradient(45deg, #1a252f, #2c3e50) !important;
            color: white !important;
            font-size: 1em;
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
            border: 2px solid #0f1419 !important;
            box-shadow: inset 0 1px 2px rgba(255,255,255,0.1), 0 1px 2px rgba(0,0,0,0.2);
        }

        .x-cell {
            background: linear-gradient(45deg, #c0392b, #a93226) !important;
            font-size: 1.1em;
            color: white !important;
            font-weight: 800;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
            border: 2px solid #8b2635 !important;
            box-shadow: inset 0 1px 2px rgba(255,255,255,0.1), 0 1px 2px rgba(0,0,0,0.2);
        }

        .highlighted-row {
            background: linear-gradient(90deg, rgba(52, 152, 219, 0.15), rgba(52, 152, 219, 0.05)) !important;
            border-left: 3px solid #3498db !important;
            border-right: 3px solid #3498db !important;
        }

        .highlighted-col {
            background: linear-gradient(0deg, rgba(46, 204, 113, 0.15), rgba(46, 204, 113, 0.05)) !important;
            border-top: 3px solid #2ecc71 !important;
            border-bottom: 3px solid #2ecc71 !important;
        }

        .answer-cell {
            background: linear-gradient(45deg, #e74c3c, #c0392b) !important;
            color: white !important;
            border: 3px solid #8b2635 !important;
            box-shadow: 0 0 15px rgba(231, 76, 60, 0.4), inset 0 2px 4px rgba(255,255,255,0.2);
            transform: scale(1.1);
            z-index: 10;
            font-size: 1.2em;
            font-weight: 800;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }

        .highlighted-row-header {
            background: linear-gradient(45deg, #3498db, #2980b9) !important;
            color: white !important;
            font-weight: 800 !important;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.3) !important;
        }

        .highlighted-col-header {
            background: linear-gradient(45deg, #2ecc71, #27ae60) !important;
            color: white !important;
            font-weight: 800 !important;
            box-shadow: 0 0 10px rgba(46, 204, 113, 0.3) !important;
        }

        .anna-placeholder {
            background: linear-gradient(45deg, #ff6b9d, #c44569) !important;
            color: white !important;
            font-weight: 800 !important;
            font-size: 1.1em !important;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8) !important;
            border: 2px solid #a93226 !important;
            box-shadow: inset 0 1px 2px rgba(255,255,255,0.1), 0 1px 2px rgba(0,0,0,0.2) !important;
        }

        .stacy-placeholder {
            background: linear-gradient(45deg, #4ecdc4, #44a08d) !important;
            color: white !important;
            font-weight: 800 !important;
            font-size: 1.1em !important;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8) !important;
            border: 2px solid #2d7d77 !important;
            box-shadow: inset 0 1px 2px rgba(255,255,255,0.1), 0 1px 2px rgba(0,0,0,0.2) !important;
        }


        .history-section {
            position: absolute;
            top: 250px;
            right: 20px;
            width: 300px;
            background: linear-gradient(45deg, #f8f9fa, #e9ecef);
            border-radius: 8px;
            padding: 5px;
            border: 2px solid #dee2e6;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            max-height: 400px;
            overflow-y: auto;
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            margin-bottom: 5px;
        }

        .history-header h3 {
            margin: 0;
            color: #495057;
            font-size: 1.3em;
        }

        .history-content {
            max-height: 500px;
            overflow: hidden;
            padding: 0;
        }

        .history-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .history-item {
            background: white;
            margin: 3px 0;
            padding: 5px 10px;
            border-radius: 6px;
            border-left: 4px solid #4ecdc4;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .history-item:hover {
            background: #f8f9fa;
            transform: translateX(5px);
            transition: all 0.2s ease;
        }

        .clear-history {
            background: #dc3545;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .clear-history:hover {
            background: #c82333;
        }

        .tooltip {
            position: absolute;
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.8em;
            white-space: nowrap;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .tooltip.show {
            opacity: 1;
        }




        /* Print Styles */
        @media print {
            body {
                background: white !important;
                padding: 0 !important;
                margin: 0 !important;
            }

            .container {
                box-shadow: none !important;
                border-radius: 0 !important;
                padding: 10px !important;
                max-width: none !important;
                page-break-inside: avoid;
            }

            .controls, .teacher-controls, .history-section {
                display: none !important;
            }

            .multiplication-display {
                position: static !important;
                transform: none !important;
                background: #f0f0f0 !important;
                color: #333 !important;
                text-shadow: none !important;
                margin: 10px 0 !important;
                padding: 15px !important;
                border: 2px solid #333 !important;
            }

            .table-container {
                margin: 0 !important;
                overflow: visible !important;
                page-break-inside: avoid;
                break-inside: avoid;
            }

            .multiplication-table {
                box-shadow: none !important;
                border: 2px solid white !important;
                page-break-inside: avoid;
                break-inside: avoid;
                width: 100% !important;
                max-width: 100% !important;
            }

            .table-cell {
                border: 1px solid white !important;
                background: white !important;
                color: black !important;
                font-weight: bold !important;
                width: 8% !important;
                height: 50px !important;
                font-size: 1em !important;
                page-break-inside: avoid;
                text-shadow: 1px 1px 2px rgba(255,255,255,0.8) !important;
            }

            .header-cell {
                background: #2c3e50 !important;
                color: white !important;
                font-weight: bold !important;
                font-size: 1.1em !important;
                border: 2px solid #000 !important;
                text-shadow: 1px 1px 2px rgba(0,0,0,0.8) !important;
            }

            .x-cell {
                background: #c0392b !important;
                color: white !important;
                font-weight: bold !important;
                font-size: 1.3em !important;
                border: 2px solid #000 !important;
                text-shadow: 1px 1px 2px rgba(0,0,0,0.8) !important;
            }

            .highlighted-row {
                background: #e3f2fd !important;
                border-left: 3px solid #3498db !important;
                border-right: 3px solid #3498db !important;
            }

            .highlighted-col {
                background: #e8f5e8 !important;
                border-top: 3px solid #2ecc71 !important;
                border-bottom: 3px solid #2ecc71 !important;
            }

            .answer-cell {
                background: #e74c3c !important;
                border: 3px solid #8b2635 !important;
                font-weight: bold !important;
                color: white !important;
                font-size: 1.2em !important;
                text-shadow: 1px 1px 2px rgba(0,0,0,0.8) !important;
            }

            .highlighted-row-header {
                background: #3498db !important;
                color: white !important;
                font-weight: bold !important;
            }

            .highlighted-col-header {
                background: #2ecc71 !important;
                color: white !important;
                font-weight: bold !important;
            }

            .anna-placeholder {
                background: #ff6b9d !important;
                color: white !important;
                font-weight: bold !important;
                font-size: 1em !important;
                text-shadow: 1px 1px 2px rgba(0,0,0,0.8) !important;
            }

            .stacy-placeholder {
                background: #4ecdc4 !important;
                color: white !important;
                font-weight: bold !important;
                font-size: 1em !important;
                text-shadow: 1px 1px 2px rgba(0,0,0,0.8) !important;
            }

            .arrow {
                display: none !important;
            }

            h1 {
                color: black !important;
                text-shadow: none !important;
                margin-bottom: 20px !important;
                font-size: 2em !important;
            }

            /* Ensure single page layout */
            @page {
                size: A4;
                margin: 0.5in;
            }

            .multiplication-table {
                font-size: 0.9em !important;
            }

            .table-cell {
                width: 7% !important;
                height: 45px !important;
                font-size: 0.9em !important;
            }

            .header-cell {
                font-size: 1em !important;
            }

            .x-cell {
                font-size: 1.1em !important;
            }
        }

        /* Black and White Print Styles */
        .print-bw .table-cell {
            background: white !important;
            color: black !important;
        }

        .print-bw .header-cell {
            background: #2c3e50 !important;
            color: white !important;
            font-size: 1.1em !important;
            font-weight: bold !important;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8) !important;
        }

        .print-bw .x-cell {
            background: #c0392b !important;
            color: white !important;
            font-size: 1.3em !important;
            font-weight: bold !important;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8) !important;
        }

        .print-bw .highlighted-row {
            background: #e3f2fd !important;
            border-left: 3px solid #3498db !important;
            border-right: 3px solid #3498db !important;
        }

        .print-bw .highlighted-col {
            background: #e8f5e8 !important;
            border-top: 3px solid #2ecc71 !important;
            border-bottom: 3px solid #2ecc71 !important;
        }

        .print-bw .answer-cell {
            background: #e74c3c !important;
            border: 3px solid #8b2635 !important;
            font-weight: bold !important;
            color: white !important;
            font-size: 1.2em !important;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8) !important;
        }

        .print-bw .highlighted-row-header {
            background: #3498db !important;
            color: white !important;
            font-weight: bold !important;
        }

        .print-bw .highlighted-col-header {
            background: #2ecc71 !important;
            color: white !important;
            font-weight: bold !important;
        }

        .print-bw .anna-placeholder {
            background: #ff6b9d !important;
            color: white !important;
            font-weight: bold !important;
            font-size: 1em !important;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8) !important;
        }

        .print-bw .stacy-placeholder {
            background: #4ecdc4 !important;
            color: white !important;
            font-weight: bold !important;
            font-size: 1em !important;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8) !important;
        }

        @media (max-width: 768px) {
            .container {
                padding: 8px;
            }

            .header-section {
                flex-direction: row;
                justify-content: space-between;
                align-items: flex-start;
                text-align: center;
                min-height: 80px;
            }

            .anna-header, .stacy-header {
                position: relative;
                flex-direction: column;
                gap: 4px;
                padding: 6px 10px;
            }

            .header-photo {
                width: 100px;
                height: 100px;
            }

            .header-name {
                font-size: 1.4em;
            }

            h1 {
                font-size: 1.8em;
                order: -1;
            }

            .history-section {
                position: absolute;
                top: 250px;
                right: 10px;
                left: 10px;
                width: auto;
                max-height: 300px;
            }

            .controls-row {
                flex-direction: column;
                gap: 10px;
                align-items: stretch;
            }

            .control-group {
                min-width: auto;
            }
            
            .table-cell {
                width: 30px;
                height: 30px;
                font-size: 0.8em;
            }
            
            .header-cell {
                font-size: 0.9em;
            }

            .multiplication-table {
                font-size: 0.8em;
            }

            h1 {
                font-size: 1.8em;
                margin-bottom: 15px;
            }

            .teacher-controls {
                flex-direction: column;
                gap: 10px;
            }

            .anna-placeholder-control,
            .stacy-placeholder-control {
                padding: 10px;
            }

            .placeholder-img {
                font-size: 2em;
            }

            .placeholder-name {
                font-size: 1em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-section">
            <div class="anna-header">
                <img src="anna.png" alt="Anna" class="header-photo">
                <span class="header-name">Anna</span>
            </div>
            <h1>üéØ Interactive Multiplication Table (12√ó12)</h1>
            <div class="multiplication-display" id="multiplication-display">
                Select two numbers to see the multiplication!
            </div>
            <div class="stacy-header">
                <img src="stacy.png" alt="Stacy" class="header-photo">
                <span class="header-name">Stacy</span>
            </div>
        </div>

       

        <div class="main-layout">
            <div class="controls-row">
                <div class="control-group" data-tooltip="Select the first number to multiply">
                    <label for="first-number">First Number:</label>
                    <select id="first-number">
                        <option value="">Choose...</option>
                    </select>
                </div>
                
                <div class="control-group" data-tooltip="Select the second number to multiply">
                    <label for="second-number">Second Number:</label>
                    <select id="second-number">
                        <option value="">Choose...</option>
                    </select>
                </div>

                <div class="control-group" data-tooltip="Auto-reset selection after specified time">
                    <label for="auto-reset">Auto Reset:</label>
                    <select id="auto-reset">
                        <option value="">Off</option>
                        <option value="5">5 seconds</option>
                        <option value="10">10 seconds</option>
                        <option value="30">30 seconds</option>
                        <option value="60">1 minute</option>
                        <option value="120">2 minutes</option>
                        <option value="180">3 minutes</option>
                        <option value="240">4 minutes</option>
                        <option value="300">5 minutes</option>
                    </select>
                </div>

                <div class="control-group" data-tooltip="Choose your favorite theme!">
                    <label for="theme-selector">Theme:</label>
                    <select id="theme-selector">
                        <option value="rainbow">üåà Rainbow</option>
                        <option value="balerina">ü©∞ Balerina</option>
                        <option value="capucina">üå∏ Capucina</option>
                        <option value="princess">üëë Princess</option>
                        <option value="unicorn">ü¶Ñ Unicorn</option>
                        <option value="butterfly" selected>ü¶ã Butterfly</option>
                        <option value="ocean">üåä Ocean</option>
                        <option value="forest">üå≤ Forest</option>
                        <option value="space">üöÄ Space</option>
                        <option value="candy">üç≠ Candy</option>
                    </select>
                </div>

            </div>

            <div class="table-container">
                <table class="multiplication-table" id="multiplication-table">
                    <!-- Table will be generated by JavaScript -->
                </table>
            </div>

            <div class="history-section">
                <div class="history-header" id="history-header">
                    <h3>üìö Calculation History</h3>
                </div>
                <div class="history-content" id="history-content">
                    <ul class="history-list" id="history-list">
                        <!-- History items will be added here -->
                    </ul>
                    <button class="clear-history" id="clear-history">Clear History</button>
                </div>
            </div>
        </div>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        // Configuration
        const TABLE_SIZE = 12;
        const MAX_HISTORY_ITEMS = 50;

        // Generate dropdown options
        function generateDropdownOptions() {
            const firstSelect = document.getElementById('first-number');
            const secondSelect = document.getElementById('second-number');
            
            for (let i = 1; i <= TABLE_SIZE; i++) {
                const option1 = document.createElement('option');
                option1.value = i;
                option1.textContent = i;
                firstSelect.appendChild(option1);
                
                const option2 = document.createElement('option');
                option2.value = i;
                option2.textContent = i;
                secondSelect.appendChild(option2);
            }
        }

        // Generate the multiplication table
        function generateTable() {
            const table = document.getElementById('multiplication-table');
            table.innerHTML = '';

            // Create header row
            const headerRow = document.createElement('tr');
            
            // Empty cell for top-left corner
            const xCell = document.createElement('td');
            xCell.className = 'table-cell x-cell';
            xCell.textContent = '√ó';
            headerRow.appendChild(xCell);

            // Column headers (1-20)
            for (let i = 1; i <= TABLE_SIZE; i++) {
                const cell = document.createElement('td');
                cell.className = 'table-cell header-cell';
                cell.textContent = i;
                cell.id = `col-${i}`;
                headerRow.appendChild(cell);
            }

            table.appendChild(headerRow);

            // Create data rows
            for (let i = 1; i <= TABLE_SIZE; i++) {
                const row = document.createElement('tr');
                
                // Row header
                const rowHeader = document.createElement('td');
                rowHeader.className = 'table-cell header-cell';
                rowHeader.textContent = i;
                rowHeader.id = `row-${i}`;
                row.appendChild(rowHeader);

                // Data cells
                for (let j = 1; j <= TABLE_SIZE; j++) {
                    const cell = document.createElement('td');
                    cell.className = 'table-cell';
                    cell.textContent = i * j;
                    cell.id = `cell-${i}-${j}`;
                    cell.style.background = getCellColor(i, j);
                    row.appendChild(cell);
                }

                table.appendChild(row);
            }
        }

        // Theme definitions
        const themes = {
            rainbow: {
                name: "üåà Rainbow",
                getCellColor: (row, col) => {
                    const value = row * col;
                    const maxValue = TABLE_SIZE * TABLE_SIZE;
                    const ratio = value / maxValue;
                    const hue = (ratio * 300) % 360;
                    const saturation = 70 + (ratio * 30);
                    const lightness = 60 + (ratio * 20);
                    return `hsl(${hue}, ${saturation}%, ${lightness}%)`;
                }
            },
            balerina: {
                name: "ü©∞ Balerina",
                getCellColor: (row, col) => {
                    const value = row * col;
                    const maxValue = TABLE_SIZE * TABLE_SIZE;
                    const ratio = value / maxValue;
                    const colors = ['#ffb6c1', '#ffc0cb', '#ffd1dc', '#ffe4e1', '#f0e6ff', '#e6e6fa', '#f8f8ff', '#fff0f5', '#ffe4e6', '#ffb3ba'];
                    return colors[Math.floor(ratio * colors.length)];
                }
            },
            capucina: {
                name: "üå∏ Capucina",
                getCellColor: (row, col) => {
                    const value = row * col;
                    const maxValue = TABLE_SIZE * TABLE_SIZE;
                    const ratio = value / maxValue;
                    const colors = ['#ff9a9e', '#fecfef', '#fecfef', '#ffecd2', '#fcb69f', '#ff8a80', '#ffab91', '#ffccbc', '#f8bbd9', '#e1bee7'];
                    return colors[Math.floor(ratio * colors.length)];
                }
            },
            princess: {
                name: "üëë Princess",
                getCellColor: (row, col) => {
                    const value = row * col;
                    const maxValue = TABLE_SIZE * TABLE_SIZE;
                    const ratio = value / maxValue;
                    const colors = ['#ffd700', '#ffb347', '#ffa500', '#ff8c00', '#ff7f50', '#ff6347', '#ff69b4', '#ff1493', '#da70d6', '#ba55d3'];
                    return colors[Math.floor(ratio * colors.length)];
                }
            },
            unicorn: {
                name: "ü¶Ñ Unicorn",
                getCellColor: (row, col) => {
                    const value = row * col;
                    const maxValue = TABLE_SIZE * TABLE_SIZE;
                    const ratio = value / maxValue;
                    const colors = ['#e6e6fa', '#d8bfd8', '#dda0dd', '#ee82ee', '#da70d6', '#ba55d3', '#9370db', '#8a2be2', '#7b68ee', '#6a5acd'];
                    return colors[Math.floor(ratio * colors.length)];
                }
            },
            butterfly: {
                name: "ü¶ã Butterfly",
                getCellColor: (row, col) => {
                    const value = row * col;
                    const maxValue = TABLE_SIZE * TABLE_SIZE;
                    const ratio = value / maxValue;
                    const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3', '#54a0ff', '#5f27cd', '#00d2d3', '#ff9f43', '#ff6b9d', '#c44569', '#f8b500', '#ff9ff3', '#54a0ff', '#5f27cd', '#00d2d3', '#ff9f43', '#ff6348', '#ff3838'];
                    return colors[Math.floor(ratio * colors.length)];
                }
            },
            ocean: {
                name: "üåä Ocean",
                getCellColor: (row, col) => {
                    const value = row * col;
                    const maxValue = TABLE_SIZE * TABLE_SIZE;
                    const ratio = value / maxValue;
                    const colors = ['#74b9ff', '#0984e3', '#00b894', '#00cec9', '#6c5ce7', '#a29bfe', '#fd79a8', '#e84393', '#fdcb6e', '#e17055'];
                    return colors[Math.floor(ratio * colors.length)];
                }
            },
            forest: {
                name: "üå≤ Forest",
                getCellColor: (row, col) => {
                    const value = row * col;
                    const maxValue = TABLE_SIZE * TABLE_SIZE;
                    const ratio = value / maxValue;
                    const colors = ['#a8e6cf', '#88d8a3', '#68c4a6', '#4a9b8e', '#2d7d77', '#1a5f5a', '#4a6741', '#6b8e23', '#8fbc8f', '#98fb98'];
                    return colors[Math.floor(ratio * colors.length)];
                }
            },
            space: {
                name: "üöÄ Space",
                getCellColor: (row, col) => {
                    const value = row * col;
                    const maxValue = TABLE_SIZE * TABLE_SIZE;
                    const ratio = value / maxValue;
                    const colors = ['#1e3c72', '#2a5298', '#3b82f6', '#6366f1', '#8b5cf6', '#a855f7', '#c084fc', '#d946ef', '#ec4899', '#f43f5e'];
                    return colors[Math.floor(ratio * colors.length)];
                }
            },
            candy: {
                name: "üç≠ Candy",
                getCellColor: (row, col) => {
                    const value = row * col;
                    const maxValue = TABLE_SIZE * TABLE_SIZE;
                    const ratio = value / maxValue;
                    const colors = ['#ff6b9d', '#c44569', '#f8b500', '#ff9ff3', '#54a0ff', '#5f27cd', '#00d2d3', '#ff9f43', '#ff6348', '#ff3838'];
                    return colors[Math.floor(ratio * colors.length)];
                }
            }
        };

        let currentTheme = 'butterfly';
        let autoResetTimer = null;
        let autoResetInterval = null;

        // Generate colors for cells based on current theme
        function getCellColor(row, col) {
            return themes[currentTheme].getCellColor(row, col);
        }

        // Clear all highlights
        function clearHighlights() {
            // Clear row highlights
            for (let i = 1; i <= TABLE_SIZE; i++) {
                const rowCells = document.querySelectorAll(`[id^="cell-${i}-"]`);
                rowCells.forEach(cell => {
                    cell.classList.remove('highlighted-row');
                });
            }

            // Clear column highlights
            for (let j = 1; j <= TABLE_SIZE; j++) {
                const colCells = document.querySelectorAll(`[id*="-${j}"]`);
                colCells.forEach(cell => {
                    cell.classList.remove('highlighted-col');
                });
            }

            // Clear answer highlight
            const answerCells = document.querySelectorAll('.answer-cell');
            answerCells.forEach(cell => {
                cell.classList.remove('answer-cell');
            });

            // Clear header highlights
            const rowHeaders = document.querySelectorAll('[id^="row-"]');
            rowHeaders.forEach(header => {
                header.classList.remove('highlighted-row-header');
            });

            const colHeaders = document.querySelectorAll('[id^="col-"]');
            colHeaders.forEach(header => {
                header.classList.remove('highlighted-col-header');
            });

            // Clear fade effects
            const allCells = document.querySelectorAll('.table-cell');
            allCells.forEach(cell => {
                cell.classList.remove('faded');
            });
        }

        // Highlight headers
        function highlightHeaders(firstNum, secondNum) {
            // Highlight row header
            const rowHeader = document.getElementById(`row-${firstNum}`);
            if (rowHeader) {
                rowHeader.classList.add('highlighted-row-header');
            }

            // Highlight column header
            const colHeader = document.getElementById(`col-${secondNum}`);
            if (colHeader) {
                colHeader.classList.add('highlighted-col-header');
            }
        }

        // Add to history
        function addToHistory(firstNum, secondNum, answer) {
            const historyList = document.getElementById('history-list');
            const historyItem = document.createElement('li');
            historyItem.className = 'history-item';
            
            const calculation = document.createElement('span');
            calculation.textContent = `${firstNum} √ó ${secondNum} = ${answer}`;
            
            const timestamp = document.createElement('span');
            timestamp.textContent = new Date().toLocaleTimeString();
            timestamp.style.fontSize = '0.8em';
            timestamp.style.color = '#666';
            
            historyItem.appendChild(calculation);
            historyItem.appendChild(timestamp);
            
            // Add to beginning of list
            historyList.insertBefore(historyItem, historyList.firstChild);
            
            // Limit history size
            const items = historyList.querySelectorAll('.history-item');
            if (items.length > MAX_HISTORY_ITEMS) {
                historyList.removeChild(items[items.length - 1]);
            }
        }

        // Highlight single number (row or column)
        function highlightSingleNumber(num, type) {
            clearHighlights();

            if (!num) return;

            if (type === 'row') {
                // Highlight the row
                for (let j = 1; j <= TABLE_SIZE; j++) {
                    const cell = document.getElementById(`cell-${num}-${j}`);
                    if (cell) {
                        cell.classList.add('highlighted-row');
                    }
                }
                // Highlight row header
                const rowHeader = document.getElementById(`row-${num}`);
                if (rowHeader) {
                    rowHeader.classList.add('highlighted-row-header');
                }
            } else if (type === 'col') {
                // Highlight the column
                for (let i = 1; i <= TABLE_SIZE; i++) {
                    const cell = document.getElementById(`cell-${i}-${num}`);
                    if (cell) {
                        cell.classList.add('highlighted-col');
                    }
                }
                // Highlight column header
                const colHeader = document.getElementById(`col-${num}`);
                if (colHeader) {
                    colHeader.classList.add('highlighted-col-header');
                }
            }

            // Update display
            const display = document.getElementById('multiplication-display');
            if (type === 'row') {
                display.textContent = `Row ${num} selected - choose a second number!`;
            } else if (type === 'col') {
                display.textContent = `Column ${num} selected - choose a first number!`;
            }
        }

        // Highlight the multiplication path
        function highlightMultiplication(firstNum, secondNum) {
            clearHighlights();

            if (!firstNum || !secondNum) return;

            const answer = firstNum * secondNum;

            // Update display
            const display = document.getElementById('multiplication-display');
            display.textContent = `${firstNum} √ó ${secondNum} = ${answer}`;

            // Add to history
            addToHistory(firstNum, secondNum, answer);

            // Highlight the row
            for (let j = 1; j <= TABLE_SIZE; j++) {
                const cell = document.getElementById(`cell-${firstNum}-${j}`);
                if (cell) {
                    cell.classList.add('highlighted-row');
                }
            }

            // Highlight the column
            for (let i = 1; i <= TABLE_SIZE; i++) {
                const cell = document.getElementById(`cell-${i}-${secondNum}`);
                if (cell) {
                    cell.classList.add('highlighted-col');
                }
            }

            // Highlight the answer cell
            const answerCell = document.getElementById(`cell-${firstNum}-${secondNum}`);
            if (answerCell) {
                answerCell.classList.add('answer-cell');
            }

            // Add fade effect to non-selected cells
            for (let i = 1; i <= TABLE_SIZE; i++) {
                for (let j = 1; j <= TABLE_SIZE; j++) {
                    if (i !== firstNum && j !== secondNum) {
                        const cell = document.getElementById(`cell-${i}-${j}`);
                        if (cell) {
                            cell.classList.add('faded');
                        }
                    }
                }
            }

            // Highlight headers
            highlightHeaders(firstNum, secondNum);

            // Start auto-reset timer
            startAutoReset();

            // Update URL
            updateURL(firstNum, secondNum);
        }

        // Update URL parameters
        function updateURL(firstNum, secondNum) {
            const url = new URL(window.location);
            if (firstNum && secondNum) {
                url.searchParams.set('a', firstNum);
                url.searchParams.set('b', secondNum);
            } else {
                url.searchParams.delete('a');
                url.searchParams.delete('b');
            }
            window.history.replaceState({}, '', url);
        }

        // Auto-reset functionality
        function startAutoReset() {
            clearAutoReset();
            const autoResetSelect = document.getElementById('auto-reset');
            const resetTime = parseInt(autoResetSelect.value);
            
            if (resetTime && resetTime > 0) {
                autoResetTimer = setTimeout(() => {
                    clearHighlights();
                    document.getElementById('first-number').value = '';
                    document.getElementById('second-number').value = '';
                    document.getElementById('multiplication-display').textContent = 'Select two numbers to see the result!';
                }, resetTime * 1000);
            }
        }

        function clearAutoReset() {
            if (autoResetTimer) {
                clearTimeout(autoResetTimer);
                autoResetTimer = null;
            }
        }


        // Tooltip functionality
        function initTooltips() {
            const tooltip = document.getElementById('tooltip');
            const tooltipElements = document.querySelectorAll('[data-tooltip]');
            
            tooltipElements.forEach(element => {
                element.addEventListener('mouseenter', (e) => {
                    tooltip.textContent = e.target.getAttribute('data-tooltip');
                    tooltip.classList.add('show');
                });
                
                element.addEventListener('mouseleave', () => {
                    tooltip.classList.remove('show');
                });
                
                element.addEventListener('mousemove', (e) => {
                    tooltip.style.left = e.pageX + 10 + 'px';
                    tooltip.style.top = e.pageY - 10 + 'px';
                });
            });
        }

        // History section functionality
        function initHistory() {
            const clearHistoryBtn = document.getElementById('clear-history');
            
            clearHistoryBtn.addEventListener('click', () => {
                document.getElementById('history-list').innerHTML = '';
            });
        }

        // Theme switching functionality
        function switchTheme(themeName) {
            currentTheme = themeName;
            document.body.className = `theme-${themeName}`;
            
            // Regenerate table with new theme colors
            generateTable();
            
            // Re-highlight current selection if any
            const firstNum = parseInt(document.getElementById('first-number').value);
            const secondNum = parseInt(document.getElementById('second-number').value);
            if (firstNum && secondNum) {
                highlightMultiplication(firstNum, secondNum);
            }
        }

        // Event listeners
        document.getElementById('first-number').addEventListener('change', function() {
            const firstNum = parseInt(this.value);
            const secondNum = parseInt(document.getElementById('second-number').value);
            
            if (firstNum && secondNum) {
                highlightMultiplication(firstNum, secondNum);
            } else if (firstNum) {
                highlightSingleNumber(firstNum, 'row');
            } else {
                clearHighlights();
                document.getElementById('multiplication-display').textContent = 'Select two numbers to see the multiplication!';
            }
        });

        document.getElementById('second-number').addEventListener('change', function() {
            const firstNum = parseInt(document.getElementById('first-number').value);
            const secondNum = parseInt(this.value);
            
            if (firstNum && secondNum) {
                highlightMultiplication(firstNum, secondNum);
            } else if (secondNum) {
                highlightSingleNumber(secondNum, 'col');
            } else {
                clearHighlights();
                document.getElementById('multiplication-display').textContent = 'Select two numbers to see the multiplication!';
            }
        });

        document.getElementById('theme-selector').addEventListener('change', function() {
            switchTheme(this.value);
        });

        document.getElementById('auto-reset').addEventListener('change', function() {
            clearAutoReset();
            if (this.value) {
                startAutoReset();
            }
        });

        // Teacher functionality
        function initTeacherControls() {
            // No teacher controls needed
        }

        // Enhanced URL parameter loading
        function loadURLParameters() {
            const urlParams = new URLSearchParams(window.location.search);
            const firstNum = urlParams.get('a');
            const secondNum = urlParams.get('b');
            const theme = urlParams.get('theme');
            
            // Load theme first
            if (theme && themes[theme]) {
                document.getElementById('theme-selector').value = theme;
                switchTheme(theme);
            }
            
            // Load selections
            if (firstNum && secondNum) {
                document.getElementById('first-number').value = firstNum;
                document.getElementById('second-number').value = secondNum;
                highlightMultiplication(parseInt(firstNum), parseInt(secondNum));
            }
        }

        // Enhanced URL parameter updating
        function updateURL(firstNum, secondNum) {
            const url = new URL(window.location);
            if (firstNum && secondNum) {
                url.searchParams.set('a', firstNum);
                url.searchParams.set('b', secondNum);
            } else {
                url.searchParams.delete('a');
                url.searchParams.delete('b');
            }
            url.searchParams.set('theme', currentTheme);
            window.history.replaceState({}, '', url);
        }

        // Initialize everything when page loads
        window.addEventListener('load', function() {
            generateDropdownOptions();
            generateTable();
            initTooltips();
            initHistory();
            initTeacherControls();
            loadURLParameters();
            
            // Set default theme
            switchTheme('butterfly');
        });
    </script>
</body>
</html>
